{"version":3,"sources":["../src/useLocalStorage/index.ts","../src/useWindowSize/index.ts","../src/useOnGlobalEvent/index.ts","../src/useNavigatorOnLine/index.ts","../src/usePrevious/index.ts","../src/useRerender/index.ts"],"sourcesContent":["/**\n * @file useLocalStorage 组件\n * @author zhifou\n */\nimport { useState } from \"react\";\n\n/**\n * 本地存储的Hook组件\n * @param {string} key 关键Key\n * @param {T} initialValue 初始值\n * @param {number} timeout 过期时间（单位：毫秒）\n */\nfunction useLocalStorage<T>(key: string, initialValue: T, timeout?: number) {\n    const remove = () => {\n        try {\n            (window as any).localStorage.removeItem(key);\n        } catch (error) {\n            console.log(error);\n        }\n    };\n\n    const [storedValue, setStoredValue] = useState(() => {\n        try {\n            const item = (window as any).localStorage.getItem(key);\n            if (item && timeout) {\n                const current = new Date().getTime();\n                const result = JSON.parse(item);\n                // 判断是否过期，已过期\n                if (result.expired < current) {\n                    remove();\n                    return initialValue;\n                }\n            }\n            return item ? JSON.parse(item).value : initialValue;\n        } catch (error) {\n            console.log(error);\n            return initialValue;\n        }\n    });\n\n    const setValue = <T>(value: T) => {\n        try {\n            const valueToStore =\n                value instanceof Function ? value(storedValue) : value;\n            setStoredValue(valueToStore);\n            const current = new Date().getTime() + (timeout || 0);\n            const item = {\n                expired: current,\n                value: valueToStore,\n            };\n            (window as any).localStorage.setItem(key, JSON.stringify(item));\n        } catch (error) {\n            console.log(error);\n        }\n    };\n\n    return [storedValue, setValue, remove];\n}\n\nexport default useLocalStorage;\n","/**\n * @file useWindowSize 组件\n * @author zhifou\n */\nimport { useEffect, useState, useCallback } from \"react\";\n\ntype Size = { width?: number; height?: number };\n\nconst useWindowSize = () => {\n    const [state, setState] = useState<Size>(() => {\n        const { clientWidth, clientHeight } = (document as Document)\n            .documentElement;\n        return {\n            width: clientWidth,\n            height: clientHeight,\n        };\n    });\n\n    const onResize = useCallback(() => {\n        const { clientWidth, clientHeight } = (document as Document)\n            .documentElement;\n        setState({\n            width: clientWidth,\n            height: clientHeight,\n        });\n    }, []);\n\n    useEffect(() => {\n        window.addEventListener(\"resize\", onResize, false);\n\n        return () => {\n            window.removeEventListener(\"resize\", onResize, false);\n        };\n    }, []);\n\n    return state;\n};\n\nexport default useWindowSize;\n","/**\n * @file useOnGlobalEvent 组件\n * @author zhifou\n */\nimport { useEffect, useRef } from \"react\";\n\nconst useOnGlobalEvent = (type, callback, options) => {\n    const listener = useRef(null);\n    const previousProps = useRef({ type, options });\n\n    useEffect(() => {\n        const { type: previousType, options: previousOptions } = previousProps;\n\n        if (listener.current) {\n            window.removeEventListener(\n                previousType,\n                listener.current,\n                previousOptions\n            );\n        }\n\n        listener.current = window.addEventListener(type, callback, options);\n        previousProps.current = { type, options };\n\n        return () => {\n            window.removeEventListener(type, listener.current, options);\n        };\n    }, [callback, type, options]);\n};\n\nexport default useOnGlobalEvent;\n","/**\n * @file useNavigatorOnline 组件\n * @author zhifou\n */\nimport React, { useEffect, useState } from \"react\";\n\nconst getOnLineStatus = () =>\n    typeof navigator !== \"undefined\" && typeof navigator.onLine === \"boolean\"\n        ? navigator.onLine\n        : true;\n\nconst useNavigatorOnline = () => {\n    const [status, setStatus] = useState(getOnLineStatus());\n\n    const setOnline = () => setStatus(true);\n    const setOffline = () => setStatus(false);\n\n    useEffect(() => {\n        window.addEventListener(\"online\", setOnline);\n        window.addEventListener(\"offline\", setOffline);\n\n        return () => {\n            window.removeEventListener(\"online\", setOnline);\n            window.removeEventListener(\"offline\", setOffline);\n        };\n    }, []);\n\n    return status;\n};\n\nexport default useNavigatorOnline;\n","import { useRef, useEffect } from \"react\";\n\nconst usePrevious = <T extends unknown>(value: T): T | undefined => {\n    const ref = useRef<T>();\n\n    useEffect(() => {\n        ref.current = value;\n    });\n\n    return ref.current;\n};\n\nexport default usePrevious;\n","import React, { useEffect, useRef } from \"react\";\n\ninterface IUseRerender {\n    logProps?: boolean;\n}\n\nexport default function useRerender(config: IUseRerender = {}) {\n    if (process.env.NODE_ENV === \"production\") {\n        return;\n    }\n\n    const logProps = config.logProps ?? true;\n\n    // @ts-ignore\n    const owner = (React as any)\n        ?.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED?.ReactCurrentOwner\n        ?.current;\n    const name = owner?.type?.name ? `<${owner.type.name} />` : \"\";\n\n    const props = owner?.pendingProps as object;\n    const propsMessage = logProps\n        ? ` with props: ${JSON.stringify(props)}`\n        : \"\";\n    const prevPropsRef = useRef<null | object>(null);\n\n    useEffect(() => {\n        console.log(`Component ${name} mounted${propsMessage}`);\n        return () => {\n            console.log(`Component ${name} unmounted`);\n        };\n    }, []);\n\n    if (prevPropsRef.current) {\n        console.log(`Component ${name} rerender${propsMessage}`);\n    }\n\n    prevPropsRef.current = props;\n}\n"],"mappings":"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","names":["useState","useEffect","useEffect","useState","useRef","useEffect","React","useEffect","useRef"]}